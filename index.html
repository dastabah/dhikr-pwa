<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Madina Institute Weekly Dhikr</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cinzel:wght@700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base styles */
        body { font-family: 'Inter', sans-serif; }
        .arabic { font-family: 'Amiri', serif; line-height: 2.5; }
        .card { background-color: #FFFFFF; border: 1px solid #E5E0D4; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 2rem; }
        .main-title { font-family: 'Cinzel', serif; font-weight: 700; letter-spacing: 0.05em; }
        .section-title { font-family: 'Amiri', serif; font-weight: 700; }

        /* PWA LAYOUT STYLES */
        html, body { margin: 0; padding: 0; overflow: hidden; height: 100%; width: 100%; background-color: #FDFBF5; }
        .swipe-container { display: flex; overflow-x: auto; width: 100vw; height: 100vh; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; scroll-behavior: smooth; }
        .page { flex: 0 0 100vw; width: 100vw; height: 100vh; overflow-y: auto; scroll-snap-align: start; padding: 1rem; padding-top: 80px; /* Space for top header */ padding-bottom: 80px; /* Space for bottom nav */ }
        .swipe-container::-webkit-scrollbar { display: none; }
        .swipe-container { -ms-overflow-style: none; scrollbar-width: none; }

        /* Table of Contents Link Styles */
        .toc-link { display: block; padding: 1rem; background-color: #FFFFFF; border: 1px solid #E5E0D4; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); font-size: 1.125rem; font-weight: 600; color: #1e3a8a; text-decoration: none; transition: transform 0.2s, box-shadow 0.2s; }
        .toc-link:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(0,0,0,0.08); }

        /* HOVER HIGHLIGHT STYLE */
        .highlightable-text:hover { background-color: #dcfce7; color: #14532d; cursor: pointer; border-radius: 6px; transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out; }
        
        /* NAV DOTS STYLE */
        .nav-dot { width: 8px; height: 8px; border-radius: 50%; background-color: #d1d5db; /* gray-300 */ transition: background-color 0.2s ease-in-out; border: none; padding: 0; }
        .nav-dot.active { background-color: #059669; /* emerald-600 */ }
        
        /* NEW TASBIH STYLES */
        #tap-area {
            user-select: none; /* Prevents text selection on rapid taps */
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent; /* Removes blue flash on tap on mobile */
        }
        #tap-area:active {
            transform: scale(0.98); /* Gives a slight press-down effect */
        }
    </style>
</head>
<body class="text-gray-800">

    <header class="fixed top-0 left-0 right-0 bg-white/80 backdrop-blur-sm border-b border-gray-200 shadow-sm z-10">
        <div class="max-w-3xl mx-auto text-center p-4">
            <h2 id="active-section-title" class="text-xl font-semibold text-emerald-800 truncate"></h2>
        </div>
    </header>

    <div class="swipe-container">

        <div class="page" id="home" data-title="Home">
            <div class="max-w-3xl mx-auto">
                <header class="text-center mb-10">
                    <img src="https://i.pinimg.com/1200x/9a/43/14/9a4314d66273d8fbe3c6aa5ebdc51471.jpg" alt="The Green Dome of the Prophet's Mosque" class="rounded-xl w-full shadow-lg mb-6">
                    <h1 class="text-4xl md:text-5xl font-bold text-emerald-900 main-title">Madina Institute Weekly Dhikr</h1>
                </header>
                <main class="space-y-4">
                    <a href="#wird" class="toc-link text-white bg-emerald-700 hover:bg-emerald-800 text-center">Start Daily Wird</a>
                    <hr class="my-6 border-emerald-200">
                    <a href="#fatihah" class="toc-link">Surah Al-Fatihah</a>
                    <a href="#istighfar" class="toc-link">Sayyidul Istighfar</a>
                    <a href="#adhkar" class="toc-link">Weekly Adhkar</a>
                    <a href="#qasaid-latifiyyah" class="toc-link">Qasida: The Latifiyyah</a>
                    <a href="#qasaid-yaleetifan" class="toc-link">Qasida: Ya Lateefan</a>
                    <a href="#qasaid-lailaha" class="toc-link">Qasida: La ilaha illa Allah</a>
                    <a href="#qasaid-muhammadiyyah" class="toc-link">Qasida: Al-Qasidatul Muhammadiyyah</a>
                    <a href="#qasaid-malana" class="toc-link">Qasida: Ma Lana Mawlan</a>
                </main>
                <footer class="text-center mt-12 py-6 border-t border-emerald-100">
                    <p class="text-gray-500 text-sm">May our gathering be accepted and blessed</p>
                </footer>
            </div>
        </div>

        <div class="page" id="wird" data-title="Daily Wird">
            <div class="max-w-3xl mx-auto flex flex-col h-full justify-between">
                <div class="text-center p-4">
                    <h2 id="dhikr-title" class="text-2xl font-bold text-emerald-800 mb-2"></h2>
                    <p id="dhikr-arabic" class="arabic text-4xl my-4"></p>
                    <p id="dhikr-transliteration" class="text-lg text-slate-700"></p>
                </div>

                <div id="tap-area" class="flex-grow flex items-center justify-center">
                    <div class="w-64 h-64 bg-emerald-600 rounded-full flex flex-col items-center justify-center text-white shadow-xl cursor-pointer transition-transform duration-100 ease-in-out">
                        <p id="current-count" class="text-7xl font-bold"></p>
                        <p class="text-2xl opacity-75">of</p>
                        <p id="total-count" class="text-3xl font-light opacity-75"></p>
                    </div>
                </div>

                <div class="h-20 text-center p-4">
                    <p id="completion-message" class="text-xl text-emerald-700 font-semibold"></p>
                </div>
            </div>
        </div>

        <div class="page" id="fatihah" data-title="Surah Al-Fatihah">
            <div class="max-w-3xl mx-auto">
                <div class="card p-6 md:p-8">
                    <h2 class="text-3xl border-b-2 border-emerald-100 pb-4 mb-6 text-emerald-900 section-title">Surah Al-Fatihah</h2>
                    <div class="space-y-6">
                        <div class="verse"><p class="arabic text-3xl md:text-4xl text-right highlightable-text">(١) بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ</p><p class="mt-3 text-slate-700 bg-slate-100 px-3 py-1 rounded-md inline-block highlightable-text">Bismillāhi-r-Raḥmāni-r-Raḥīm</p><p class="text-gray-700 mt-1 highlightable-text">1. In the name of Allah, the Entirely Merciful, the Especially Merciful</p></div><hr class="border-emerald-100">
                        <div class="verse"><p class="arabic text-3xl md:text-4xl text-right highlightable-text">(٢) الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ</p><p class="mt-3 text-slate-700 bg-slate-100 px-3 py-1 rounded-md inline-block highlightable-text">Alḥamdu lillāhi Rabbi-l-ʿālamīn</p><p class="text-gray-700 mt-1 highlightable-text">2. All praise is due to Allah, Lord of the worlds</p></div><hr class="border-emerald-100">
                        <div class="verse"><p class="arabic text-3xl md:text-4xl text-right highlightable-text">(٣) الرَّحْمَٰنِ الرَّحِيمِ</p><p class="mt-3 text-slate-700 bg-slate-100 px-3 py-1 rounded-md inline-block highlightable-text">Ar-Raḥmāni-r-Raḥīm</p><p class="text-gray-700 mt-1 highlightable-text">3. The Entirely Merciful, the Especially Merciful</p></div><hr class="border-emerald-100">
                        <div class="verse"><p class="arabic text-3xl md:text-4xl text-right highlightable-text">(٤) مَالِكِ يَوْمِ الدِّينِ</p><p class="mt-3 text-slate-700 bg-slate-100 px-3 py-1 rounded-md inline-block highlightable-text">Māliki yawmi-d-dīn</p><p class="text-gray-700 mt-1 highlightable-text">4. Sovereign of the Day of Recompense</p></div><hr class="border-emerald-100">
                        <div class="verse"><p class="arabic text-3xl md:text-4xl text-right highlightable-text">(٥) إِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ</p><p class="mt-3 text-slate-700 bg-slate-100 px-3 py-1 rounded-md inline-block highlightable-text">Iyyāka naʿbudu wa iyyāka nastaʿīn</p><p class="text-gray-700 mt-1 highlightable-text">5. It is You we worship and You we ask for help</p></div><hr class="border-emerald-100">
                        <div class="verse"><p class="arabic text-3xl md:text-4xl text-right highlightable-text">(٦) اهْدِنَا الصِّرَاطَ الْمُسْتَقِيمَ</p><p class="mt-3 text-slate-700 bg-slate-100 px-3 py-1 rounded-md inline-block highlightable-text">Ihdinā-ṣ-ṣirāṭa-l-mustaqīm</p><p class="text-gray-700 mt-1 highlightable-text">6. Guide us to the straight path</p></div><hr class="border-emerald-100">
                        <div class="verse"><p class="arabic text-3xl md:text-4xl text-right highlightable-text">(٧) صِرَاطَ الَّذِينَ أَنْعَمْتَ عَلَيْهِمْ غَيْرِ الْمَغْضُوبِ عَلَيْهِمْ وَلَا الضَّالِّينَ</p><p class="mt-3 text-slate-700 bg-slate-100 px-3 py-1 rounded-md inline-block highlightable-text">Ṣirāṭa-lladhīna anʿamta ʿalayhim ghayri-l-maghḍūbi ʿalayhim wa la-ḍ-ḍāllīn</p><p class="text-gray-700 mt-1 highlightable-text">7. The path of those upon whom You have bestowed favor, not of those who have earned Your anger or of those who are astray</p></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="page" id="istighfar" data-title="Sayyidul Istighfar">
            </div>

        <div class="page" id="adhkar" data-title="Weekly Adhkar">
            </div>
        
        <div class="page" id="qasaid-latifiyyah" data-title="Qasida: The Latifiyyah">
            </div>

        <div class="page" id="qasaid-yaleetifan" data-title="Qasida: Ya Lateefan">
            </div>

        <div class="page" id="qasaid-lailaha" data-title="Qasida: La ilaha illa Allah">
            </div>

        <div class="page" id="qasaid-muhammadiyyah" data-title="Qasida: Al-Muhammadiyyah">
            </div>

        <div class="page" id="qasaid-malana" data-title="Qasida: Ma Lana Mawlan">
            </div>

    </div>

    <nav class="fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-sm border-t border-gray-200 shadow-lg z-10">
        <div class="max-w-3xl mx-auto flex justify-between items-center px-4 py-2">
            <button id="prev-btn" class="p-3 rounded-full hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:hover:bg-transparent">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <div id="nav-dots" class="flex items-center space-x-2"></div>
            <button id="next-btn" class="p-3 rounded-full hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:hover:bg-transparent">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </button>
        </div>
    </nav>
    
    <script>
        // --- NAVIGATION LOGIC ---
        const container = document.querySelector('.swipe-container');
        const pages = document.querySelectorAll('.page');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const dotsContainer = document.getElementById('nav-dots');
        const activeTitle = document.getElementById('active-section-title');
        let currentPageIndex = 0;
        const totalPages = pages.length;
        pages.forEach((page, index) => {
            const dot = document.createElement('button');
            dot.classList.add('nav-dot');
            dot.dataset.index = index;
            dot.addEventListener('click', () => scrollToPage(index));
            dotsContainer.appendChild(dot);
        });
        const dots = document.querySelectorAll('.nav-dot');
        function updateUI(index) {
            activeTitle.innerText = pages[index].dataset.title || '';
            prevBtn.disabled = index === 0;
            nextBtn.disabled = index === totalPages - 1;
            prevBtn.classList.toggle('opacity-50', index === 0);
            nextBtn.classList.toggle('opacity-50', index === totalPages - 1);
            dots.forEach((dot, dotIndex) => {
                dot.classList.toggle('active', dotIndex === index);
            });
            // If the Daily Wird page becomes active, reset the counter
            if (pages[index].id === 'wird') {
                resetWird();
            }
        }
        function scrollToPage(index) {
            const targetPage = pages[index];
            if (targetPage) {
                container.scrollTo({ left: targetPage.offsetLeft });
            }
        }
        prevBtn.addEventListener('click', () => { if (currentPageIndex > 0) scrollToPage(currentPageIndex - 1); });
        nextBtn.addEventListener('click', () => { if (currentPageIndex < totalPages - 1) scrollToPage(currentPageIndex + 1); });
        let scrollTimeout;
        container.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                const newIndex = Math.round(container.scrollLeft / container.offsetWidth);
                if (newIndex !== currentPageIndex) {
                    currentPageIndex = newIndex;
                    updateUI(newIndex);
                }
            }, 150);
        });
        document.querySelectorAll('.toc-link').forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                const targetIndex = Array.from(pages).findIndex(page => page.id === targetId);
                if (targetIndex !== -1) scrollToPage(targetIndex);
            });
        });

        // --- TASBIH COUNTER LOGIC ---
        const wirdSequence = [
            { title: "Istighfar (Cleansing)", arabic: "أَسْتَغْفِرُ اللهَ الْعَظِيمَ وَأَتُوبُ إِلَيْهِ", transliteration: "Astaghfirullāha-l-ʿAẓīm wa atūbu ilayh", target: 100 },
            { title: "Tahlil (Strengthening)", arabic: "لَا إِلَٰهَ إِلَّا اللَّهُ", transliteration: "Lā ilāha illā Allāh", target: 100 },
            { title: "Salawat (Beautifying)", arabic: "اللَّهُمَّ صَلِّ عَلَىٰ سَيِّدِنَا مُحَمَّدٍ النُّورِ وَآلِهِ", transliteration: "Allāhumma ṣalli ʿalā Sayyidinā Muḥammadin an-Nūr wa ālih", target: 100 }
        ];
        const dhikrTitleEl = document.getElementById('dhikr-title');
        const dhikrArabicEl = document.getElementById('dhikr-arabic');
        const dhikrTransliterationEl = document.getElementById('dhikr-transliteration');
        const tapAreaEl = document.getElementById('tap-area');
        const currentCountEl = document.getElementById('current-count');
        const totalCountEl = document.getElementById('total-count');
        const completionMessageEl = document.getElementById('completion-message');
        let wirdIndex = 0;
        let currentCount = 0;
        function updateDhikrUI() {
            if (wirdIndex < wirdSequence.length) {
                const currentDhikr = wirdSequence[wirdIndex];
                dhikrTitleEl.innerText = currentDhikr.title;
                dhikrArabicEl.innerText = currentDhikr.arabic;
                dhikrTransliterationEl.innerText = currentDhikr.transliteration;
                currentCountEl.innerText = currentCount;
                totalCountEl.innerText = currentDhikr.target;
                completionMessageEl.innerText = '';
                tapAreaEl.style.cursor = 'pointer';
            } else {
                dhikrTitleEl.innerText = "Completed";
                dhikrArabicEl.innerText = "ما شاء الله";
                dhikrTransliterationEl.innerText = "Masha'Allah";
                currentCountEl.innerText = '✓';
                totalCountEl.innerText = '';
                completionMessageEl.innerText = "Your daily wird is complete. May it be accepted!";
                tapAreaEl.style.cursor = 'default';
            }
        }
        function handleTap() {
            if (wirdIndex >= wirdSequence.length) return;
            currentCount++;
            currentCountEl.innerText = currentCount;
            if (navigator.vibrate) { navigator.vibrate(50); }
            if (currentCount >= wirdSequence[wirdIndex].target) {
                wirdIndex++;
                currentCount = 0;
                if (navigator.vibrate) navigator.vibrate([100, 30, 100]);
                setTimeout(updateDhikrUI, 600);
            }
        }
        function resetWird() {
             wirdIndex = 0;
             currentCount = 0;
             updateDhikrUI();
        }
        tapAreaEl.addEventListener('click', handleTap);
        
        // --- INITIALIZE ---
        updateUI(0);
        resetWird();
    </script>
</body>
</html>